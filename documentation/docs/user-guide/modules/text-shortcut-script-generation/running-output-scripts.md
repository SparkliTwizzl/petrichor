---
short_title: Running output scripts
title: Running output scripts - Text Shortcut Script Generation module
---

<h1 align="center">Running output scripts</h1>
<h2 align="center"><a href="./index.html">Text Shortcut Script Generation module</a></h2>


---
## Requirements

The requirements to run a text shortcut script generated by Petrichor are listed below.


---
### AutoHotkey

The scripts that this module generates are AutoHotkey v2 scripts.

In order to run them, you will need to install [AutoHotkey](https://www.autohotkey.com).


---
## Running text shortcut scripts

With AutoHotkey installed, simply double-click the script ( `.ahk` file ).

You can also right-click on it and click `run` in the context menu.

---
## Automatically run scripts after generating them

You can make a [batch script](../../getting-started/command-usage.md/#running-petrichor-via-batch-file) wait for Petrichor to finish running and launch the output script automatically.

1. Create a batch script using the steps linked above.
2. After the `start` keyword, add `/wait`. This will cause the batch script to wait until Petrichor is closed before continuing.
3. Add a new line to the batch script, and enter `start [path/script.ahk]`.
4. Save the batch file.

Once you've done these steps, you can run the `.bat` file by double clicking it. Assuming the `.bat` file was made correctly, it will run Petrichor with all the arguments you set, wait until it closes, then launch the output script.

!!! note

	If Petrichor fails to generate a new script, any existing version of the output script will be launched instead.

???+ example

	``` title="Folder contents"
	- parent\
		- Petrichor\
			- Petrichor.exe
		- example batch file.bat
		- inputFile.txt
	```
	=== "Command in command line arguments"

		```batch title="example batch file.bat"
		start /wait Petrichor\Petrichor.exe commandName --inputFile ..\inputFile.txt
		start outputFile.ahk
		```

	=== "Command in input file"

		```batch title="example batch file.bat"
		start /wait Petrichor\Petrichor.exe ..\inputFile.txt
		start outputFile.ahk
		```

---
## Launching scripts automatically on startup

There are a few options to launch scripts automatically when Windows logs in.

---
### Windows Startup shortcut

!!! important "Recommended"

	This is the simplest and most reliable method.

1. Right-click the script in File Explorer.
2. Click `Create shortcut` in the dropdown menu.
3. Press `Win+R` to open the Windows Run dialog.
4. Type `shell:startup` into the dialog, then click OK.
5. The Startup folder will open. Copy the shortcut you created in step 2 into it.

---
### Task Scheduler

!!! important "Not recommended"

	This method is somewhat unreliable.

	It is also tedious and awkward to set up.

The Windows Startup method is easier and more reliable.

Using this method is only recommended if the Windows Startup method does not work.

Follow the directions [here](https://windowsloop.com/run-autohotkey-script-at-windows-startup/) to set it up.

---
### Registry

!!! important "Strongly not recommended"

	It is strongly reecommended to use one of the other methods above, unless all of them dont work for you.

!!! danger

	DO NOT DO THIS UNLESS YOU KNOW WHAT YOU'RE DOING.

	Editing the registry can brick your computer if you're not careful.


1. Open the Registry Editor. There are two days to do this:
    - Press `Win+R` to open the Run dialog, type in `regedit`, then click OK.
    - Open the Start menu and search for either `regedit` or `Registry Editor`.
2. Navigate to `HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Run`.
3. Add a new String key. Name it however you prefer.
4. Edit the value of the new string key and put in `"@:\path\to\autohotkey\version\file.exe" "@:\path\to\script\file.ahk"`, using the filepaths of your AutoHotkey installation and your script file.
